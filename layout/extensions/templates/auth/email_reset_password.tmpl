package email

import (
	"bytes"
	"context"
)

type ResetPassword struct {
	ResetURL string
}

var _ Transformer = (*ResetPassword)(nil)

func (r ResetPassword) ToHTML() (string, error) {
	var buf bytes.Buffer
	if err := r.render().Render(context.Background(), &buf); err != nil {
		return "", err
	}
	return buf.String(), nil
}

func (r ResetPassword) ToText() (string, error) {
	html, err := r.ToHTML()
	if err != nil {
		return "", err
	}
	return HTMLToText(html)
}

templ (r ResetPassword) render() {
	@baseLayout("Reset Your Password", "Reset your password using the link provided.", "#") {
		<h1 style="margin-top: 0; margin-bottom: 24px; font-size: 24px; font-weight: bold; color: #333333;">
			Reset Your Password
		</h1>
		<p>Hi, </p>
		<p>
			We received a request to reset your password. Click the button below to reset your password:
		</p>
		<div style="text-align: center; margin: 32px 0;">
			@button(r.ResetURL, "Reset My Password")
		</div>
		<p>Or copy and paste this link into your browser:</p>
		<p style="word-break: break-all; color: #0867ec;">
			{ r.ResetURL }
		</p>
		<p>This link will expire in 1 hour for security reasons.</p>
		<p>If you didn't request a password reset, please ignore this email. Your password will remain unchanged.</p>
		<p style="margin-bottom: 0;">
			Best regards,
			<br/>
			The Andurel Team
		</p>
	}
}
