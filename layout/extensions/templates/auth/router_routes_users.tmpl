package routes

import (
	"net/http"
	"strings"

	"github.com/google/uuid"
)

const (
	usersRoutePrefix = "/users"
	usersNamePrefix  = "users"
)

var UserRoutes = []Route{
	UserIndex,
	UserShow.Route,
	UserEdit.Route,
	UserUpdate.Route,
	UserDestroy.Route,
}

var UserIndex = Route{
	Name:             usersNamePrefix + ".index",
	Path:             usersRoutePrefix,
	Method:           http.MethodGet,
	Controller:       "Users",
	ControllerMethod: "Index",
}

var UserShow = usersShow{
	Route: Route{
		Name:             usersNamePrefix + ".show",
		Path:             usersRoutePrefix + "/:id",
		Method:           http.MethodGet,
		Controller:       "Users",
		ControllerMethod: "Show",
	},
}

type usersShow struct {
	Route
}

func (r usersShow) GetPath(id uuid.UUID) string {
	return strings.Replace(r.Path, ":id", id.String(), 1)
}

var UserNew = Route{
	Name:             usersNamePrefix + ".new",
	Path:             usersRoutePrefix + "/new",
	Method:           http.MethodGet,
	Controller:       "Users",
	ControllerMethod: "New",
}

var UserCreate = Route{
	Name:             usersNamePrefix + ".create",
	Path:             usersRoutePrefix,
	Method:           http.MethodPost,
	Controller:       "Users",
	ControllerMethod: "Create",
}

var UserEdit = usersEdit{
	Route: Route{
		Name:             usersNamePrefix + ".edit",
		Path:             usersRoutePrefix + "/:id/edit",
		Method:           http.MethodGet,
		Controller:       "Users",
		ControllerMethod: "Edit",
	},
}

type usersEdit struct {
	Route
}

func (r usersEdit) GetPath(id uuid.UUID) string {
	return strings.Replace(r.Path, ":id", id.String(), 1)
}

var UserUpdate = usersUpdate{
	Route: Route{
		Name:             usersNamePrefix + ".update",
		Path:             usersRoutePrefix + "/:id",
		Method:           http.MethodPut,
		Controller:       "Users",
		ControllerMethod: "Update",
	},
}

type usersUpdate struct {
	Route
}

func (r usersUpdate) GetPath(id uuid.UUID) string {
	return strings.Replace(r.Path, ":id", id.String(), 1)
}

var UserDestroy = usersDestroy{
	Route: Route{
		Name:             usersNamePrefix + ".destroy",
		Path:             usersRoutePrefix + "/:id",
		Method:           http.MethodDelete,
		Controller:       "Users",
		ControllerMethod: "Destroy",
	},
}

type usersDestroy struct {
	Route
}

func (r usersDestroy) GetPath(id uuid.UUID) string {
	return strings.Replace(r.Path, ":id", id.String(), 1)
}

var RegistrationRoutes = []Route{
	RegistrationNew,
	RegistrationCreate,
}

var ConfirmationRoutes = []Route{
	ConfirmationNew,
	ConfirmationCreate,
}

var SessionRoutes = []Route{
	SessionNew,
	SessionCreate,
	SessionDestroy,
}

var SessionNew = Route{
	Name:             "new_user_session",
	Path:             usersRoutePrefix + "/sign_in",
	Method:           http.MethodGet,
	Controller:       "Sessions",
	ControllerMethod: "New",
}

var SessionCreate = Route{
	Name:             "user_session",
	Path:             usersRoutePrefix + "/sign_in",
	Method:           http.MethodPost,
	Controller:       "Sessions",
	ControllerMethod: "Create",
}

var SessionDestroy = Route{
	Name:             "destroy_user_session",
	Path:             usersRoutePrefix + "/sign_out",
	Method:           http.MethodPost,
	Controller:       "Sessions",
	ControllerMethod: "Destroy",
}

var PasswordRoutes = []Route{
	PasswordNew,
	PasswordCreate,
	PasswordEdit.Route,
	PasswordUpdate,
}

var PasswordNew = Route{
	Name:             "new_user_password",
	Path:             usersRoutePrefix + "/password/new",
	Method:           http.MethodGet,
	Controller:       "ResetPassword",
	ControllerMethod: "New",
}

var PasswordCreate = Route{
	Name:             "user_password",
	Path:             usersRoutePrefix + "/password",
	Method:           http.MethodPost,
	Controller:       "ResetPassword",
	ControllerMethod: "Create",
}

var PasswordEdit = passwordEdit{
	Route: Route{
		Name:             "edit_user_password",
		Path:             usersRoutePrefix + "/password/:token/edit",
		Method:           http.MethodGet,
		Controller:       "ResetPassword",
		ControllerMethod: "Edit",
	},
}

type passwordEdit struct {
	Route
}

func (r passwordEdit) GetPath(token string) string {
	return strings.Replace(r.Path, ":token", token, 1)
}

var PasswordUpdate = Route{
	Name:             "user_password_update",
	Path:             usersRoutePrefix + "/password",
	Method:           http.MethodPut,
	Controller:       "ResetPassword",
	ControllerMethod: "Update",
}

var RegistrationNew = Route{
	Name:             "new_user_registration",
	Path:             usersRoutePrefix + "/sign_up",
	Method:           http.MethodGet,
	Controller:       "Registrations",
	ControllerMethod: "New",
}

var RegistrationCreate = Route{
	Name:             "user_registration",
	Path:             usersRoutePrefix,
	Method:           http.MethodPost,
	Controller:       "Registrations",
	ControllerMethod: "Create",
}

var ConfirmationNew = Route{
	Name:             "new_user_confirmation",
	Path:             usersRoutePrefix + "/confirmation/new",
	Method:           http.MethodGet,
	Controller:       "Confirmations",
	ControllerMethod: "New",
}

var ConfirmationCreate = Route{
	Name:             "user_confirmation",
	Path:             usersRoutePrefix + "/confirmation",
	Method:           http.MethodPost,
	Controller:       "Confirmations",
	ControllerMethod: "Create",
}
