package components

// --- Class helpers ---

func dropdownClasses(class string) string {
	return cn("relative inline-block text-left", class)
}

func dropdownContentClasses(class string) string {
	base := "z-50 min-w-[8rem] overflow-hidden rounded-box border border-base-300 bg-base-100 p-1 text-base-content shadow-md"
	return cn(base, class)
}

func dropdownItemClasses(disabled bool, class string) string {
	base := "relative flex cursor-pointer select-none items-center rounded-field px-2 py-1.5 text-sm outline-none transition-colors hover:bg-base-200 focus:bg-base-200"
	if disabled {
		return cn(base, "opacity-60 cursor-not-allowed", class)
	}
	return cn(base, class)
}

func dropdownLabelClasses(class string) string {
	return cn("px-2 py-1.5 text-sm font-semibold text-base-content", class)
}

// --- Templ ---

// Dropdown creates a menu that appears when a trigger element is activated. Use it for
// action menus, context menus, or navigation sub-menus. Compose with DropdownTrigger,
// DropdownContent, DropdownItem, DropdownLabel, and DropdownSeparator sub-components.
//
//	@components.Dropdown() {
//		@components.DropdownTrigger() {
//			@components.Button(components.ButtonProps{Label: "Open Menu"}).Render()
//		}
//		@components.DropdownContent() {
//			@components.DropdownLabel("Actions")
//			@components.DropdownSeparator()
//			@components.DropdownItem("Edit", false)
//			@components.DropdownItem("Delete", false)
//		}
//	}
templ Dropdown(opts ...Opt) {
	<div class={ dropdownClasses(classFrom(opts)) } if attrsFrom(opts) != nil { { attrsFrom(opts)... } }>
		{ children... }
	</div>
}

templ DropdownTrigger(opts ...Opt) {
	<div class={ cn("cursor-pointer", classFrom(opts)) } if attrsFrom(opts) != nil { { attrsFrom(opts)... } }>
		{ children... }
	</div>
}

templ DropdownContent(opts ...Opt) {
	<div class={ dropdownContentClasses(classFrom(opts)) } role="menu" if attrsFrom(opts) != nil { { attrsFrom(opts)... } }>
		{ children... }
	</div>
}

templ DropdownItem(label string, disabled bool, opts ...Opt) {
	<div class={ dropdownItemClasses(disabled, classFrom(opts)) } role="menuitem" if attrsFrom(opts) != nil { { attrsFrom(opts)... } }>
		{ label }
	</div>
}

templ DropdownSeparator() {
	<div class="-mx-1 my-1 h-px bg-base-300"></div>
}

templ DropdownLabel(label string, opts ...Opt) {
	<div class={ dropdownLabelClasses(classFrom(opts)) } if attrsFrom(opts) != nil { { attrsFrom(opts)... } }>
		{ label }
	</div>
}
