package components

// --- Builder ---

type CarouselBuilder struct {
	id         string
	class      string
	attrs      templ.Attributes
	fragmentID string
}

func Carousel() *CarouselBuilder {
	return &CarouselBuilder{}
}

func (b *CarouselBuilder) WithID(id string) *CarouselBuilder     { b.id = id; return b }
func (b *CarouselBuilder) WithClass(c string) *CarouselBuilder   { b.class = cn(b.class, c); return b }
func (b *CarouselBuilder) SetClass(c string) *CarouselBuilder    { b.class = c; return b }
func (b *CarouselBuilder) WithAttr(key string, val any) *CarouselBuilder {
	if b.attrs == nil { b.attrs = templ.Attributes{} }
	b.attrs[key] = val; return b
}
func (b *CarouselBuilder) WithFragment(id string) *CarouselBuilder { b.fragmentID = id; return b }

// --- Class helpers ---

func carouselClasses(b *CarouselBuilder) string {
	return cn("relative w-full", b.class)
}

func carouselContentClasses(class string) string {
	return cn("flex overflow-hidden -ml-4", class)
}

func carouselItemClasses(class string) string {
	return cn("min-w-0 shrink-0 grow-0 basis-full pl-4", class)
}

func carouselBtnClasses(extra string) string {
	return cn("absolute top-1/2 -translate-y-1/2 inline-flex items-center justify-center h-8 w-8 rounded-full border border-base-300 bg-base-100 text-base-content shadow-sm transition hover:bg-base-200 cursor-pointer disabled:opacity-60 disabled:cursor-not-allowed", extra)
}

// --- Templ ---

templ (b *CarouselBuilder) Render() {
	if b.fragmentID != "" {
		@templ.Fragment(b.fragmentID) {
			@b.render()
		}
	} else {
		@b.render()
	}
}

templ (b *CarouselBuilder) render() {
	<div
		class={ carouselClasses(b) }
		role="region"
		aria-roledescription="carousel"
		if b.id != "" {
			id={ b.id }
		}
		if b.attrs != nil {
			{ b.attrs... }
		}
	>
		{ children... }
	</div>
}

templ CarouselContent(class string, attrs templ.Attributes) {
	<div class={ carouselContentClasses(class) } if attrs != nil { { attrs... } }>
		{ children... }
	</div>
}

templ CarouselItem(class string, attrs templ.Attributes) {
	<div class={ carouselItemClasses(class) } role="group" aria-roledescription="slide" if attrs != nil { { attrs... } }>
		{ children... }
	</div>
}

templ CarouselPrevious(class string, attrs templ.Attributes) {
	<button type="button" class={ carouselBtnClasses(cn("-left-12", class)) } aria-label="Previous slide" if attrs != nil { { attrs... } }>
		<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"></path></svg>
	</button>
}

templ CarouselNext(class string, attrs templ.Attributes) {
	<button type="button" class={ carouselBtnClasses(cn("-right-12", class)) } aria-label="Next slide" if attrs != nil { { attrs... } }>
		<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"></path></svg>
	</button>
}
