package components

import "strconv"

// --- Types ---

type RatingProps struct {
	ID         string
	Class      string
	Attributes templ.Attributes
	Name       string
	Value      int
	Max        int
	Disabled   bool
}

// --- Class helpers ---

func ratingClasses(p RatingProps) string {
	return cn("flex items-center gap-1", p.Class)
}

// --- Templ ---

templ Rating(props ...RatingProps) {
	{{ "{{" }} var p RatingProps {{ "}}" }}
	if len(props) > 0 {
		{{ "{{" }} p = props[0] {{ "}}" }}
	}
	if p.Max == 0 {
		{{ "{{" }} p.Max = 5 {{ "}}" }}
	}
	<div class={ ratingClasses(p) } role="radiogroup" { p.Attributes... }>
		for i := 1; i <= p.Max; i++ {
			<label class={ cn("cursor-pointer", func() string { if p.Disabled { return "cursor-not-allowed opacity-60" }; return "" }()) }>
				<input
					type="radio"
					class="sr-only peer"
					if p.Name != "" {
						name={ p.Name }
					}
					value={ strconv.Itoa(i) }
					if i == p.Value {
						checked
					}
					if p.Disabled {
						disabled
					}
				/>
				<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class={ cn("transition-colors", func() string { if i <= p.Value { return "fill-warning text-warning" }; return "fill-none text-base-content/30" }()) }><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>
			</label>
		}
	</div>
}
